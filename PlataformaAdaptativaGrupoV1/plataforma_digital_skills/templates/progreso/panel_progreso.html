<!-- templates/progreso/panel_progreso.html -->
{% extends 'base.html' %}

{% block content %}
<div class="card">
    <h1>📈 Tu Progreso de Aprendizaje</h1>
    <p>Revisa tu avance en las competencias digitales</p>
    
    <div class="grid">
        <!-- Resultados del diagnóstico -->
        <div class="card card-security">
            <h3>🎯 Resultados del Diagnóstico</h3>
            {% for resultado in resultados %}
            <div style="margin: 1rem 0; padding: 1rem; background: white; border-radius: 5px;">
                <div style="display: flex; justify-content: between; align-items: center;">
                    <strong>{{ resultado.modulo.nombre }}</strong>
                    <span style="background: {% if resultado.puntaje >= 70 %}#2ecc71{% else %}#e74c3c{% endif %}; 
                                  color: white; padding: 0.25rem 0.5rem; border-radius: 15px;">
                        {{ resultado.puntaje|floatformat:0 }}%
                    </span>
                </div>
                <div style="margin-top: 0.5rem;">
                    <div style="background: #ecf0f1; height: 10px; border-radius: 5px;">
                        <div style="background: {% if resultado.puntaje >= 70 %}#2ecc71{% else %}#e74c3c{% endif %}; 
                                    height: 100%; width: {{ resultado.puntaje }}%; border-radius: 5px;"></div>
                    </div>
                </div>
                {% if resultado.necesita_refuerzo %}
                <small style="color: #e74c3c;">⚠️ Necesitas reforzar este módulo</small>
                {% else %}
                <small style="color: #2ecc71;">✅ Nivel satisfactorio</small>
                {% endif %}
            </div>
            {% empty %}
            <p>📝 Completa el diagnóstico para ver tus resultados.</p>
            {% endfor %}
        </div>
        
        <!-- Módulos recomendados -->
        <div class="card card-office">
            <h3>📚 Módulos Recomendados</h3>
            {% for item in progreso %}
            <div style="margin: 1rem 0; padding: 1rem; background: white; border-radius: 5px;">
                <div style="display: flex; justify-content: between; align-items: center;">
                    <strong>{{ item.modulo.nombre }}</strong>
                    <span>{{ item.porcentaje_completado }}%</span>
                </div>
                <div style="margin-top: 0.5rem;">
                    <div style="background: #ecf0f1; height: 10px; border-radius: 5px;">
                        <div style="background: #3498db; height: 100%; width: {{ item.porcentaje_completado }}%; border-radius: 5px;"></div>
                    </div>
                </div>
                <a href="{% url 'lista_modulos' %}" class="btn" style="margin-top: 0.5rem;">Continuar →</a>
            </div>
            {% empty %}
            <p>🎉 ¡No tienes módulos pendientes! Tu diagnóstico fue excelente.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}